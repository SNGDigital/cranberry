<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/byutv-jsonp/byutv-jsonp.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../../bower_components/iron-icons/social-icons.html">
<link rel="import" href="../../bower_components/iron-icons/editor-icons.html">
<link rel="import" href="../../bower_components/page-title/page-title.html">
<link rel="import" href="../cranberry-slider/cranberry-slider.html">
<link rel="import" href="../gigya-comments/gigya-comments.html">
<link rel="import" href="../gigya-sharebar/gigya-sharebar.html">
<link rel="import" href="../google-dfp/google-dfp.html">
<link rel="import" href="../cranberry-related-content/cranberry-related-content.html">

<dom-module id="cranberry-gallery">
  <template>
    <style>
      @import "cranberry-gallery/cranberry-gallery";
    </style>

    <app-route route="{{route}}" pattern="/:id" data="{{routeData}}"></app-route>
    <byutv-jsonp on-response="_handleResponse" id="request"></byutv-jsonp>

    <iron-media-query query="(min-width: 960px)" query-matches="{{desktop}}"></iron-media-query>
    <iron-media-query query="(min-width: 720px) and (max-width:959px)" query-matches="{{tablet}}"></iron-media-query>
    <iron-media-query query="(max-width: 719px)" query-matches="{{mobile}}"></iron-media-query>

    <page-title base-title="{$ config.title $}" title="[[gallery.title]]"></page-title>

    <div class="header-advertisement">
      <google-dfp
        section="[[gallery.sectionInformation.sectionName]]"
        section-parent="[[gallery.sectionInformation.sectionParentName]]"
        tags="[[gallery.tags]]"
        ad-pos="leaderboard"
        ad-size-mapping="leaderboard"
        ad-size="[[970, 250],[970, 90],[728, 90],[320, 50]]"
        ad-group="{$ config.dfpAdStructure.adGroupID $}"
        ad-grouping="{$ config.dfpAdStructure.adGrouping $}"
        ad-sub-grouping="{$ config.dfpAdStructure.adSubGrouping $}"
        id="topAd">
      </google-dfp>
    </div>

    <div class="top-media">
      <div class="gallery-slider-container" desktop-layout$="{{desktop}}" tablet-layout$="{{tablet}}" mobile-layout$="{{mobile}}">
        <cranberry-slider id="mainSlider" base-url="{$ config.baseDomain $}" items="{{gallery.mediaAssets.images}}" mobile-layout$="{{mobile}}" gallery="{{gallery}}">
          <div class="gallery-tag" hidden$="{{noTags}}">
            <span class="content-tag">{{tags.0}}</span>
          </div>
          <div class="expand-link">
            <paper-button raised class="rounded-button" on-tap="_openModal"><iron-icon icon="icons:fullscreen"></iron-icon></paper-button>
          </div>
          <div class="share-buttons">
            <paper-button raised id="buyButton" class="rounded-button" on-tap="_buyImage"><iron-icon icon="editor:attach-money"></iron-icon></paper-button>
            <gigya-sharebar share-buttons-id="gigya-share-buttons-gallery" title="[[gallery.title]]" route="[[route]]"></gigya-sharebar>
          </div>
        </cranberry-slider>
      </div>
      <div class="ad-container">
        <google-dfp section="[[gallery.sectionInformation.sectionName]]"
                      section-parent="[[gallery.sectionInformation.sectionParentName]]"
                      tags="[[gallery.tags]]"
                      ad-pos="Top_of_Stream"
                      ad-size="[[300, 250],[300, 600]]"
                      ad-group="{$ config.dfpAdStructure.adGroupID $}"
                      ad-grouping="{$ config.dfpAdStructure.adGrouping $}"
                      ad-sub-grouping="{$ config.dfpAdStructure.adSubGrouping $}"
                      id="sideAd">
          </google-dfp>
      </div>
    </div>

    <div class="gallery-description-container">
      <p class="gallery-date">[[gallery.updated]]</p>
      <h2 class="gallery-headline">[[gallery.title]]</h2>
      <p class="gallery-description">[[gallery.FullText]]</p>
    </div>

    <div class="content-container">
      <div class="gallery-images-container">
        <template is="dom-repeat" items="{{gallery.mediaAssets.images}}" initial-count="5">
          <iron-image class="gallery-image" src$="{$ config.baseDomain $}{{item.small}}" sizing="cover" data-index$="{{index}}" style="background-color: lightgray;" preload on-tap="_goToSlide" fade></iron-image>
        </template>
      </div>
      <div class="gallery-container-ad">
        <google-dfp section="[[gallery.sectionInformation.sectionName]]"
                    section-parent="[[gallery.sectionInformation.sectionParentName]]"
                    tags="[[gallery.tags]]"
                    ad-pos="Bottom_of_Stream"
                    ad-size="[[300, 250],[300, 600]]"
                    ad-group="{$ config.dfpAdStructure.adGroupID $}"
                    ad-grouping="{$ config.dfpAdStructure.adGrouping $}"
                    ad-sub-grouping="{$ config.dfpAdStructure.adSubGrouping $}">
        </google-dfp>
      </div>
      <div class="tout-sdk tout-right-rail-embed"></div>
    </div>

    <div class="header-advertisement">
      <google-dfp
        section="[[gallery.sectionInformation.sectionName]]"
        section-parent="[[gallery.sectionInformation.sectionParentName]]"
        tags="[[gallery.tags]]"
        ad-pos="middle_of_stream"
        ad-size-mapping="leaderboard"
        ad-size="[[970, 250],[970, 90],[728, 90],[320, 50]]"
        ad-group="{$ config.dfpAdStructure.adGroupID $}"
        ad-grouping="{$ config.dfpAdStructure.adGrouping $}"
        ad-sub-grouping="{$ config.dfpAdStructure.adSubGrouping $}">
      </google-dfp>
    </div>

    <div class="recommended-container">
      <div class="youneeq-container">
        <youneeq-content user="[[user]]" content="[[gallery]]" domain="{$ config.baseDomain $}"></youneeq-content>
      </div>
      <div class="recommended-content-container">
        <cranberry-related-content related-items="[[gallery.relatedContent]]" story></cranberry-related-content>
        <cranberry-related-content related-items="[[gallery.relatedContent]]" gallery></cranberry-related-content>
      </div>
    </div>

    <div class="comments-container">
      <gigya-comments stream-id="[[gallery.genericLink]]" content="[[gallery]]"  config-id="{$ config.gigya.commentsId $}"></gigya-comments>
    </div>

    <div class="header-advertisement">
      <google-dfp
        section="[[gallery.sectionInformation.sectionName]]"
        section-parent="[[gallery.sectionInformation.sectionParentName]]"
        tags="[[gallery.tags]]"
        ad-pos="Last_of_Stream"
        ad-size-mapping="leaderboard"
        ad-size="[[970, 250],[970, 90],[728, 90],[320, 50]]"
        ad-group="{$ config.dfpAdStructure.adGroupID $}"
        ad-grouping="{$ config.dfpAdStructure.adGrouping $}"
        ad-sub-grouping="{$ config.dfpAdStructure.adSubGrouping $}">
      </google-dfp>
    </div>

    <google-dfp
        section="[[gallery.sectionInformation.sectionName]]"
        section-parent="[[gallery.sectionInformation.sectionParentName]]"
        ad-pos="adhesion"
        ad-group="{$ config.dfpAdStructure.adGroupID $}"
        ad-grouping="{$ config.dfpAdStructure.adGrouping $}"
        ad-sub-grouping="{$ config.dfpAdStructure.adSubGrouping $}"
        out-of-page>
      </google-dfp>

      <google-dfp
        section="[[gallery.sectionInformation.sectionName]]"
        section-parent="[[gallery.sectionInformation.sectionParentName]]"
        ad-pos="interstitial"
        ad-group="{$ config.dfpAdStructure.adGroupID $}"
        ad-grouping="{$ config.dfpAdStructure.adGrouping $}"
        ad-sub-grouping="{$ config.dfpAdStructure.adSubGrouping $}"
        out-of-page>
      </google-dfp>
  </template>
    <script src="cranberry-gallery.js"></script>
</dom-module>
