<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/byutv-jsonp/byutv-jsonp.html">
<link rel="import" href="../../bower_components/iron-icons/social-icons.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../cranberry-shortcode/cranberry-shortcode.html">
<link rel="import" href="../youneeq-content/youneeq-content.html">
<link rel="import" href="../gigya-comments/gigya-comments.html">
<link rel="import" href="../gigya-sharebar/gigya-sharebar.html">
<link rel="import" href="../google-dfp/google-dfp.html">

<dom-module id="cranberry-story">

  <template>
    <!-- Polymer 1.1 and above recommends placing style within template https://www.polymer-project.org/1.0/docs/devguide/styling -->
    <style>
      @import "cranberry-story/cranberry-story";
    </style>

    <iron-media-query query="(min-width: 960px)" query-matches="{{desktop}}"></iron-media-query>
    <iron-media-query query="(min-width: 720px) and (max-width:959px)" query-matches="{{tablet}}"></iron-media-query>
    <iron-media-query query="(max-width:719px)" query-matches="{{mobile}}"></iron-media-query>

    <app-route route="{{route}}" pattern="/:id" data="{{routeData}}"></app-route>
    <byutv-jsonp on-response="_handleResponse" id="request"></byutv-jsonp>

    <div class="Cranberry-Story">
      <!-- Top Ad -->
      <div class="ut-center">
        <!-- Placeholder element for leaderboard ad. -->
        <google-dfp section="[[story.sectionInformation.sectionName]]" section-parent="[[story.sectionInformation.sectionParentName]]" ad-pos="leaderboard_bottom" ad-size="[[728, 90]]" ad-group="{$ config.dfpAdStructure.adGroupID $}" ad-grouping="{$ config.dfpAdStructure.adGrouping $}" ad-sub-grouping="{$ config.dfpAdStructure.adSubGrouping $}"></google-dfp>
      </div>

      <!-- Headline -->
      <h1 class="story-title"> {{story.title}} </h1>
      <p class="time-stamp"> {{story.updated}} </p>

      <!-- Story Media -->
      <div class="story-media">
        <iron-image id="mainImage" desktop-layout$="{{desktop}}" tablet-layout$="{{tablet}}" mobile-layout$="{{mobile}}" sizing="cover" src="{$ config.baseDomain $}{{story.mediaAssets.images.0.exlarge}}"></iron-image>
        <div class="ut-rowFlex ut-absolute">
          <paper-fab mini src="../../../images/social/FacebookLogo_29.png" id="facebookButton" class="ut-small-icon-margin" social-name="{$ config.socialNaming.facebook $}"></paper-fab>
          <paper-fab mini src="../../../images/social/TwitterLogo_white.png" title="Share on Twitter" id="twitterButton" class="ut-small-icon-margin" social-name="{$ config.socialNaming.twitter $}"></paper-fab>
          <paper-fab mini icon="communication:chat-bubble" title="Comments" id="commentButton" class="ut-small-icon-margin" on-tap="_scrollToComments"></paper-fab>
          <gigya-sharebar share-buttons-id="gigya-share-buttons-story"></gigya-sharebar>
        </div>
      </div>

      <p class="caption-text main-image-caption">{{story.mediaAssets.images.0.caption}}</p>

      <!-- Story Byline -->
      <div class="body-text by-line-wrapper">
        <img src="{{_computeBylineURL(story.byline.image)}}" class="ut-circle-image"/>
        <div class="by-line-info">
          <p>{{story.byline.inputByLine}}</p>
          <p>{% if story.byline.name != undefined %}
              {{story.byline.name}}
             {% else %}
              {{story.byline.inputByline}}
             {% endif %}
          </p>
          <p>{{story.byline.jobtitle}}</p>
        </div>
      </div>

      <!-- Story Content Area -->
      <div class="content-wrapper">
        <!-- Contains story paragraphs -->
        <div class="story-content">
          <div class="body-text" id="storyContentArea"></div>
        </div>
        <!-- Contains Right Rail -->
        <div class="right-rail">
          <div>
            <google-dfp
              section="[[story.sectionInformation.sectionName]]"
              section-parent="[[story.sectionInformation.sectionParentName]]"
              ad-pos="Top_of_Stream" ad-size="[[300, 250],[300, 600]]"
              ad-group="{$ config.dfpAdStructure.adGroupID $}"
              ad-grouping="{$ config.dfpAdStructure.adGrouping $}"
              ad-sub-grouping="{$ config.dfpAdStructure.adSubGrouping $}">
            </google-dfp>
            <iron-image src="http://www.placehold.it/300x250&amp;text=House Promo"></iron-image>
            <google-dfp
              section="[[story.sectionInformation.sectionName]]"
              section-parent="[[story.sectionInformation.sectionParentName]]"
              ad-pos="Middle_of_Stream" ad-size="[[300, 250]]"
              ad-group="{$ config.dfpAdStructure.adGroupID $}"
              ad-grouping="{$ config.dfpAdStructure.adGrouping $}"
              ad-sub-grouping="{$ config.dfpAdStructure.adSubGrouping $}">
            </google-dfp>
            <google-dfp
              section="[[story.sectionInformation.sectionName]]"
              section-parent="[[story.sectionInformation.sectionParentName]]"
              ad-pos="Bottom_of_Stream" ad-size="[[300, 250],[300, 600]]"
              ad-group="{$ config.dfpAdStructure.adGroupID $}"
              ad-grouping="{$ config.dfpAdStructure.adGrouping $}"
              ad-sub-grouping="{$ config.dfpAdStructure.adSubGrouping $}">
            </google-dfp>
          </div>
        </div>
      </div>

      <!-- Middle Ad -->
      <div class="ut-center">
        <google-dfp
          section="[[story.sectionInformation.sectionName]]"
          section-parent="[[story.sectionInformation.sectionParentName]]"
          ad-pos="Middle_of_Stream" ad-size="[[970, 250],[970, 90],[728, 90],[320, 50]]"
          ad-group="{$ config.dfpAdStructure.adGroupID $}"
          ad-grouping="{$ config.dfpAdStructure.adGrouping $}"
          ad-sub-grouping="{$ config.dfpAdStructure.adSubGrouping $}">
        </google-dfp>
      </div>

      <!-- Comments -->
      <div class="ut-center">
        <gigya-comments comments-id="story-comments" comments-unique-id="[[storyId]]"></gigya-comments>
      </div>

      <!-- Bottom Ad -->
      <div class="ut-center">
        <google-dfp
          section="[[story.sectionInformation.sectionName]]"
          section-parent="[[story.sectionInformation.sectionParentName]]"
          ad-pos="Middle_of_Stream" ad-size="[[970, 250],[970, 90],[728, 90],[320, 50]]"
          ad-group="{$ config.dfpAdStructure.adGroupID $}"
          ad-grouping="{$ config.dfpAdStructure.adGrouping $}"
          ad-sub-grouping="{$ config.dfpAdStructure.adSubGrouping $}">
        </google-dfp>
      </div>

      <!-- Youneeq Content Area -->
      <div class="ut-center">
        <youneeq-content user="[[user]]" story="[[story]]" domain="{$ config.baseDomain $}"></youneeq-content>
      </div>

      <!-- Last Ad -->
      <div class="ut-center">
        <google-dfp
          section="[[story.sectionInformation.sectionName]]"
          section-parent="[[story.sectionInformation.sectionParentName]]"
          ad-pos="Last_of_Stream" ad-size="[[970, 250],[970, 90],[728, 90],[320, 50]]"
          ad-group="{$ config.dfpAdStructure.adGroupID $}"
          ad-grouping="{$ config.dfpAdStructure.adGrouping $}"
          ad-sub-grouping="{$ config.dfpAdStructure.adSubGrouping $}">
        </google-dfp>
      </div>

  </template>

  <!-- Add cranberry-story Polymer Object script -->
  <script src="cranberry-story.js"></script>

</dom-module>
